# CLAUDE.md - UbuntuÃ—XP Desktop Portfolio Project

**Son GÃ¼ncelleme:** 2025-10-20 (Proje baÅŸlangÄ±cÄ±)  
**Versiyon:** 0.1.0-alpha  
**Status:** ğŸŸ¡ MVP GeliÅŸtirme AÅŸamasÄ±

---

## ğŸ“‹ Ä°Ã§indekiler

1. [Proje BaÄŸlamÄ±](#proje-baÄŸlamÄ±)
2. [Mimari Kararlar ve MantÄ±k](#mimari-kararlar-ve-mantÄ±k)
3. [Ã–ÄŸrenilen Dersler (Lessons Learned)](#Ã¶ÄŸrenilen-dersler)
4. [Hata KÃ¼tÃ¼phanesi ve Ã‡Ã¶zÃ¼mler](#hata-kÃ¼tÃ¼phanesi-ve-Ã§Ã¶zÃ¼mler)
5. [Best Practices ve KalÄ±plar](#best-practices-ve-kalÄ±plar)
6. [Gelecek Claude'a Notlar](#gelecek-claudea-notlar)
7. [Changelog Sistemi](#changelog-sistemi)
8. [Meta: Bu DosyayÄ± GÃ¼ncelleme ProtokolÃ¼](#meta-bu-dosyayÄ±-gÃ¼ncelleme-protokolÃ¼)

---

## ğŸ¯ Proje BaÄŸlamÄ±

### Proje Ã–zeti
Ubuntu 22.04 ve Windows XP estetiÄŸini birleÅŸtiren, tamamen serversÄ±z (Cloudflare Pages), masaÃ¼stÃ¼ simÃ¼lasyonu sunan, VFS (Virtual File System) ile dosya yÃ¶netimi yapabilen, dinamik GitHub projelerini gÃ¶steren, oyunlar iÃ§eren, PWA destekli modern portfolyo.

### Kritik Ã–zellikler
- **ServersÄ±z Mimari:** Cloudflare Pages + IndexedDB + localStorage
- **Ä°ki Mod:** Desktop (full masaÃ¼stÃ¼ UX) + Mobile (adaptive launcher/sheet UX)
- **VFS:** IndexedDB tabanlÄ± sanal dosya sistemi (CRUD, export/import)
- **Window Manager:** Drag/drop, resize, minimize/maximize, z-index yÃ¶netimi
- **Dinamik Ä°Ã§erik:** GitHub API (ETag cache), PDF.js, Markdown render (DOMPurify)
- **GÃ¼venlik:** CSP headers, sanitization, iframe sandbox
- **Performans:** LCP<2s, INP<100ms, CLS<0.1, JS bundle <180KB gzip

### Tech Stack
```
Frontend: React 18 + TypeScript + Vite
State: Zustand (modular slices)
Storage: IndexedDB (VFS) + localStorage (preferences)
Styling: CSS Modules + CSS Variables (theme system)
PWA: Workbox + manifest.webmanifest
Deployment: Cloudflare Pages (Git-based CI/CD)
```

### Dizin YapÄ±sÄ± (Hedef)
```
/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ os/                    # Core OS katmanÄ±
â”‚   â”‚   â”œâ”€â”€ store/            # Zustand slices
â”‚   â”‚   â”œâ”€â”€ vfs/              # Virtual File System
â”‚   â”‚   â”œâ”€â”€ types.ts          # Tip tanÄ±mlarÄ±
â”‚   â”‚   â”œâ”€â”€ eventBus.ts       # Pub/sub sistem
â”‚   â”‚   â””â”€â”€ perf/             # RAF scheduler, throttle
â”‚   â”œâ”€â”€ ui/                    # UI bileÅŸenleri
â”‚   â”‚   â”œâ”€â”€ Window.tsx
â”‚   â”‚   â”œâ”€â”€ Taskbar.tsx
â”‚   â”‚   â”œâ”€â”€ DesktopIcon.tsx
â”‚   â”‚   â”œâ”€â”€ ContextMenu.tsx
â”‚   â”‚   â””â”€â”€ mobile/           # Mobil-Ã¶zel bileÅŸenler
â”‚   â”œâ”€â”€ apps/                  # Uygulamalar (lazy-loaded)
â”‚   â”‚   â”œâ”€â”€ pdf-viewer/
â”‚   â”‚   â”œâ”€â”€ github-viewer/
â”‚   â”‚   â”œâ”€â”€ browser/
â”‚   â”‚   â”œâ”€â”€ games/
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”œâ”€â”€ themes/               # CSS token setleri
â”‚   â””â”€â”€ main.tsx
â”œâ”€â”€ old/                      # ArÅŸivlenmiÅŸ eski site
â”‚   â”œâ”€â”€ legacy-src/
â”‚   â”œâ”€â”€ legacy-public/
â”‚   â””â”€â”€ vite.config.legacy.ts
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ legacy/              # Build sonrasÄ± eski site
â”‚   â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ _headers
â”‚   â”œâ”€â”€ _redirects
â”‚   â””â”€â”€ manifest.webmanifest
â””â”€â”€ CLAUDE.md               # Bu dosya (living document)
```

---

## ğŸ—ï¸ Mimari Kararlar ve MantÄ±k

### Karar #1: Zustand ile ModÃ¼ler State YÃ¶netimi
**Tarih:** 2025-10-20  
**BaÄŸlam:** Redux gibi aÄŸÄ±r Ã§Ã¶zÃ¼mler yerine hafif, TypeScript-friendly state manager gerekti.  
**Karar:** Zustand, her domain (desktop, windows, vfs, settings) iÃ§in ayrÄ± slice'lar.  
**MantÄ±k:**
- Redux boilerplate'i yok, performans overhead minimal
- Immer entegrasyonu kolay (immutable updates)
- Slice'lar lazy-load edilebilir, tree-shaking friendly
- Middleware ile localStorage persist kolay

**Trade-off:** DevTools Redux kadar zengin deÄŸil, ama simplicity kazandÄ±k.

---

### Karar #2: Transform-Based Window Positioning
**Tarih:** 2025-10-20  
**BaÄŸlam:** Window drag performansÄ± kritik (INP <100ms hedefi).  
**Karar:** `position: absolute` + `transform: translate3d()` kullan, `left/top` deÄŸil.  
**MantÄ±k:**
- `left/top` layout thrashing tetikler (reflow)
- `transform` GPU-accelerated, compositor thread'de Ã§alÄ±ÅŸÄ±r
- Layout shift yok (CLS=0)
- RAF (requestAnimationFrame) ile batch update

**Dikkat:** `will-change: transform` dikkatli kullan, memory overhead var.

---

### Karar #3: IndexedDB for VFS, localStorage for Preferences
**Tarih:** 2025-10-20  
**BaÄŸlam:** Dosya sistemi bÃ¼yÃ¼k veri (MB), tercihler kÃ¼Ã§Ã¼k (KB).  
**Karar:** VFS â†’ IndexedDB, settings/layout â†’ localStorage.  
**MantÄ±k:**
- IndexedDB: async, quota ~50MB (mobil) - ~1GB (desktop), structured clone
- localStorage: sync, 5-10MB limit, string-only (JSON.stringify gerekli)
- VFS CRUD sÄ±k ama aÄŸÄ±r, localStorage nadir ama hÄ±zlÄ± olmalÄ±

**Quota Handling:** 80% dolulukta kullanÄ±cÄ±ya uyarÄ± + export prompt.

---

### Karar #4: Lazy-Load Apps with Code-Splitting
**Tarih:** 2025-10-20  
**BaÄŸlam:** Ä°lk yÃ¼k bundle <180KB gzip hedefi, ama PDF.js 200KB+.  
**Karar:** TÃ¼m apps `React.lazy()` ile dynamic import, Suspense fallback.  
**MantÄ±k:**
- KullanÄ±cÄ± yalnÄ±zca aÃ§tÄ±ÄŸÄ± app'i download eder
- Vite otomatik chunk'lar (vendor, common, per-app)
- Preload stratejisi: hover â†’ prefetch (optional)

**Route-Based Split:** Her app kendi route'unda lazy-load, shared components ayrÄ± chunk.

---

### Karar #5: ETag-Based GitHub API Cache
**Tarih:** 2025-10-20  
**BaÄŸlam:** GitHub API 60 req/hour (unauthenticated), rate-limit riski.  
**Karar:** ETag header + IndexedDB cache, 304 Not Modified â†’ cache hit.  
**MantÄ±k:**
- Ä°lk request: data + ETag IndexedDB'ye kaydet
- Sonraki request: `If-None-Match: ETag` header
- 304 response â†’ cache kullan, network tasarrufu
- 200 response â†’ cache gÃ¼ncelle

**Fallback:** Rate-limit (429) â†’ cache-first + "Refresh" butonu + 1 saat cooldown.

---

### Karar #6: CSP Strict Mode with Nonce
**Tarih:** 2025-10-20  
**BaÄŸlam:** GÃ¼venlik kritik, XSS saldÄ±rÄ±larÄ±na karÅŸÄ± savunma.  
**Karar:** `Content-Security-Policy: default-src 'self'; script-src 'self' 'nonce-{random}'; ...`  
**MantÄ±k:**
- Inline script yok (nonce gerekli)
- `eval()` disabled
- External resources whitelist (api.github.com, cdn.cloudflare.com)
- Iframe sandbox: `allow-scripts allow-same-origin` (minimal)

**Test:** Sentry CSP report modÃ¼lÃ¼ ile production'da violation tracking.

---

## ğŸ“š Ã–ÄŸrenilen Dersler

### Ders #001: IndexedDB Transaction Rollback Ä°dempotency
**Tarih:** -  
**Senaryo:** (HenÃ¼z karÅŸÄ±laÅŸÄ±lmadÄ±, ama Ã¶ngÃ¶rÃ¼lÃ¼yor)  
**Sorun:** VFS CRUD transaction fail olursa state inconsistent kalabilir.  
**Ã‡Ã¶zÃ¼m:** 
- Her CRUD operation idempotent olmalÄ± (aynÄ± input â†’ aynÄ± output)
- Transaction error â†’ rollback + retry (max 3 kez)
- Zustand store state yalnÄ±zca DB commit sonrasÄ± gÃ¼ncellenmeli

**Uygulama:**
```typescript
async function createNode(node: VFSNode): Promise<void> {
  const tx = db.transaction('nodes', 'readwrite');
  try {
    await tx.objectStore('nodes').add(node);
    await tx.done; // Commit bekle
    store.setState(draft => { draft.nodes[node.id] = node; }); // Ancak sonra state
  } catch (err) {
    // tx otomatik rollback olur
    console.error('createNode failed, state unchanged:', err);
    throw err; // UI'a hata gÃ¶nder
  }
}
```

**Ä°leri Not:** Conflict resolution stratejisi ekle (last-write-wins vs merge).

---

### Ders #002: Mobile Safari 50MB IndexedDB Quota
**Tarih:** -  
**Senaryo:** (Mobil test sÄ±rasÄ±nda keÅŸfedilecek)  
**Sorun:** Safari iOS'ta IndexedDB quota ~50MB, desktop'a gÃ¶re Ã§ok dÃ¼ÅŸÃ¼k.  
**Ã‡Ã¶zÃ¼m:**
- Dosya iÃ§erikleri Base64 yerine binary (Blob) olarak sakla (30% daha az yer)
- Compression: `pako` library ile gzip (text files iÃ§in 70% tasarruf)
- Cleanup job: 90 gÃ¼n eriÅŸilmeyen trash items otomatik sil

**Monitoring:**
```typescript
async function checkQuota() {
  if ('storage' in navigator && 'estimate' in navigator.storage) {
    const { usage, quota } = await navigator.storage.estimate();
    const usagePercent = (usage / quota) * 100;
    if (usagePercent > 80) {
      showWarning('Storage 80% full. Export your data or delete old files.');
    }
  }
}
```

---

### Ders #003: RAF Batch Updates for Drag Performance
**Tarih:** -  
**Senaryo:** (Window drag test'te INP >100ms olursa)  
**Sorun:** Her mousemove event'inde setState â†’ re-render â†’ layout thrashing.  
**Ã‡Ã¶zÃ¼m:**
- MouseMove event'lerini throttle (son 16ms'de bir iÅŸle)
- RAF scheduler: batch updates, frame sonunda tek setState

```typescript
let pendingUpdate: WindowBounds | null = null;

function onMouseMove(e: MouseEvent) {
  pendingUpdate = { x: e.clientX, y: e.clientY };
  requestAnimationFrame(() => {
    if (pendingUpdate) {
      store.updateWindowBounds(windowId, pendingUpdate);
      pendingUpdate = null;
    }
  });
}
```

**Ã–lÃ§Ã¼m:** PerformanceObserver ile INP track et, p95 <100ms hedefini valide et.

---

### Ders #004: DOMPurify Config for Markdown
**Tarih:** -  
**Senaryo:** (GitHub README render'da XSS risk)  
**Sorun:** `marked.js` output'u raw HTML, `<script>` inject riski.  
**Ã‡Ã¶zÃ¼m:** DOMPurify strict config:
```typescript
import DOMPurify from 'dompurify';

const clean = DOMPurify.sanitize(dirtyHTML, {
  ALLOWED_TAGS: ['p', 'a', 'ul', 'ol', 'li', 'code', 'pre', 'strong', 'em', 'h1', 'h2', 'h3'],
  ALLOWED_ATTR: ['href', 'class'], // rel="noopener noreferrer" otomatik eklenir
  ALLOW_DATA_ATTR: false,
  FORBID_TAGS: ['script', 'style', 'iframe', 'object', 'embed'],
});
```

**Test:** Malicious input listesi hazÄ±rla, sanitize sonrasÄ± `<script>` yok mu kontrol et.

---

### Ders #005: Iframe X-Frame-Options Detection
**Tarih:** -  
**Senaryo:** (Browser app'te site gÃ¶mÃ¼lmÃ¼yor)  
**Sorun:** `X-Frame-Options: DENY` header'Ä± olan siteler iframe'de yÃ¼klenmez (blank screen).  
**Ã‡Ã¶zÃ¼m:** 
- Iframe `onload` event'i yoksa + `onerror` yoksa â†’ timeout (3s) sonra fallback
- Preview card + "Open in new tab" gÃ¶ster

```typescript
function tryIframe(url: string) {
  const iframe = document.createElement('iframe');
  const timeout = setTimeout(() => {
    // 3s yÃ¼klenmedi â†’ X-Frame-Options var varsayÄ±mÄ±
    showFallback(url);
  }, 3000);
  
  iframe.onload = () => {
    clearTimeout(timeout);
    // Ä°Ã§erik yÃ¼klendi, iframe gÃ¶ster
  };
  
  iframe.src = url;
}
```

**Alternatif:** Fetch request â†’ CORS error â†’ fallback (ama CORS error catch edilemiyor, timeout mecburi).

---

## ğŸ› Hata KÃ¼tÃ¼phanesi ve Ã‡Ã¶zÃ¼mler

### Hata #001: Vite Build - Dynamic Import Chunk Error
**Tarih:** -  
**Durum:** ğŸŸ¡ Ã–ngÃ¶rÃ¼len (henÃ¼z karÅŸÄ±laÅŸÄ±lmadÄ±)  
**Belirtiler:** Production build'de lazy-loaded app aÃ§Ä±lÄ±rken `ChunkLoadError: Loading chunk X failed.`  
**KÃ¶k Neden:** CDN cache invalidation eksik, eski chunk URL'leri invalid.  
**Ã‡Ã¶zÃ¼m:**
1. Vite config'de `build.rollupOptions.output.chunkFileNames` â†’ hash ekle: `[name]-[hash].js`
2. Cloudflare Pages auto-invalidate (default), manuel invalidation gerekmez
3. Service Worker: chunk load fail â†’ fallback to cache + kullanÄ±cÄ±ya "Reload" prompt

**Ã–nleme:**
```typescript
// main.tsx
window.addEventListener('error', (e) => {
  if (e.message.includes('ChunkLoadError')) {
    console.error('Chunk load failed, reloading...');
    window.location.reload();
  }
});
```

---

### Hata #002: Zustand DevTools - Store Updates Not Reflecting
**Tarih:** -  
**Durum:** ğŸŸ¡ Ã–ngÃ¶rÃ¼len  
**Belirtiler:** Store state deÄŸiÅŸiyor ama Redux DevTools gÃ¶stermiyor.  
**KÃ¶k Neden:** Zustand middleware order yanlÄ±ÅŸ, `devtools()` en dÄ±ÅŸta olmalÄ±.  
**Ã‡Ã¶zÃ¼m:**
```typescript
// âŒ YanlÄ±ÅŸ
const useStore = create(
  persist(
    devtools((set) => ({ /* state */ })),
    { name: 'storage' }
  )
);

// âœ… DoÄŸru
const useStore = create(
  devtools(
    persist((set) => ({ /* state */ }), { name: 'storage' }),
    { name: 'MyStore' }
  )
);
```

---

### Hata #003: Mobile Safari - Touch Event Passive Warning
**Tarih:** -  
**Durum:** ğŸŸ¡ Ã–ngÃ¶rÃ¼len  
**Belirtiler:** Console: `[Violation] Added non-passive event listener to a scroll-blocking 'touchmove' event.`  
**KÃ¶k Neden:** TouchMove listener default'ta passive deÄŸil, scroll engelliyor.  
**Ã‡Ã¶zÃ¼m:**
```typescript
element.addEventListener('touchmove', handler, { passive: true });
// EÄŸer preventDefault() gerekiyorsa (Ã¶r. swipe gesture):
element.addEventListener('touchmove', handler, { passive: false });
```

**Trade-off:** `passive: false` â†’ scroll jank, ama custom gesture iÃ§in mecburi.

---

### Hata #004: GitHub API - 403 Forbidden (Rate Limit)
**Tarih:** -  
**Durum:** ğŸ”´ Kritik (karÅŸÄ±laÅŸÄ±labilir)  
**Belirtiler:** API response 403, body: `"API rate limit exceeded"`  
**KÃ¶k Neden:** Unauthenticated 60 req/hour, authenticated 5000 req/hour.  
**Ã‡Ã¶zÃ¼m:**
1. **KÄ±sa Vade:** ETag cache + 1 saat TTL â†’ request sayÄ±sÄ±nÄ± azalt
2. **Orta Vade:** `localStorage` â†’ last fetch timestamp, 1 saat geÃ§medi ise cache kullan
3. **Uzun Vade (optional):** OAuth App token â†’ 5000 req/hour (ama client-side token risky)

**Fallback UI:**
```tsx
{isRateLimited && (
  <Alert>
    GitHub API rate limit exceeded. Showing cached data.
    <Button onClick={() => retry()}>Retry in {cooldownMinutes}m</Button>
  </Alert>
)}
```

---

### Hata #005: IndexedDB - QuotaExceededError
**Tarih:** -  
**Durum:** ğŸŸ¡ Ã–ngÃ¶rÃ¼len  
**Belirtiler:** `DOMException: QuotaExceededError: The quota has been exceeded.`  
**KÃ¶k Neden:** KullanÄ±cÄ± VFS'e Ã§ok fazla dosya eklemiÅŸ, IndexedDB dolu.  
**Ã‡Ã¶zÃ¼m:**
```typescript
try {
  await db.put('nodes', largeNode);
} catch (err) {
  if (err.name === 'QuotaExceededError') {
    showModal({
      title: 'Storage Full',
      message: 'Your virtual file system is full. Export your data or delete old files.',
      actions: [
        { label: 'Export as JSON', onClick: exportVFS },
        { label: 'Open Trash', onClick: navigateToTrash },
      ],
    });
  }
}
```

**Proaktif Monitoring:** Her 10 CRUD operation'da bir quota check, 80% threshold uyarÄ±sÄ±.

---

## âœ… Best Practices ve KalÄ±plar

### Pattern #1: VFS Node CRUD (Idempotent Transactions)
```typescript
// src/os/vfs/crud.ts
export async function createNode(node: VFSNode): Promise<void> {
  // 1. Validate input
  if (!node.id || !node.name) throw new Error('Invalid node');
  
  // 2. Check existence (idempotency)
  const existing = await db.get('nodes', node.id);
  if (existing) {
    console.warn('Node already exists, skipping create');
    return;
  }
  
  // 3. Transaction
  const tx = db.transaction('nodes', 'readwrite');
  await tx.objectStore('nodes').add(node);
  await tx.done; // Commit
  
  // 4. Update state (after commit)
  vfsStore.getState().addNode(node);
}
```

**Neden Ä°yi:** Transaction fail â†’ state bozulmaz, retry gÃ¼venli.

---

### Pattern #2: Window Focus Management (Z-Index Stack)
```typescript
// src/os/store/windows.ts
focusWindow: (id: string) => set(state => {
  const maxZ = Math.max(...state.windows.map(w => w.zIndex), 0);
  return {
    windows: state.windows.map(w =>
      w.id === id
        ? { ...w, zIndex: maxZ + 1, state: w.state === 'minimized' ? 'normal' : w.state }
        : w
    ),
  };
}),
```

**Neden Ä°yi:** Z-indexì¶©ëŒ yok, minimize'dan restore otomatik.

---

### Pattern #3: Lazy App Loader with Suspense
```typescript
// src/apps/appLoader.ts
import { lazy, Suspense } from 'react';

const appRegistry = {
  'pdf-viewer': lazy(() => import('./pdf-viewer/PdfViewer')),
  'github-viewer': lazy(() => import('./github-viewer/GithubViewer')),
};

export function AppLoader({ appId, ...props }) {
  const AppComponent = appRegistry[appId];
  if (!AppComponent) return <div>App not found</div>;
  
  return (
    <Suspense fallback={<AppSkeleton />}>
      <AppComponent {...props} />
    </Suspense>
  );
}
```

**Neden Ä°yi:** Code-splitting otomatik, fallback UX smooth.

---

### Pattern #4: ETag Cache Wrapper
```typescript
// src/os/api/githubCache.ts
export async function fetchWithETag(url: string): Promise<any> {
  const cached = await db.get('apiCache', url);
  const headers: HeadersInit = {};
  
  if (cached?.etag) {
    headers['If-None-Match'] = cached.etag;
  }
  
  const res = await fetch(url, { headers });
  
  if (res.status === 304) {
    // Not Modified â†’ cache hit
    return cached.data;
  }
  
  if (res.ok) {
    const data = await res.json();
    const etag = res.headers.get('ETag');
    await db.put('apiCache', { url, data, etag, timestamp: Date.now() });
    return data;
  }
  
  throw new Error(`Fetch failed: ${res.status}`);
}
```

**Neden Ä°yi:** Network tasarrufu, rate-limit azaltma, offline fallback.

---

### Pattern #5: Performance Measurement Wrapper
```typescript
// src/os/perf/measure.ts
export function measureAsync<T>(name: string, fn: () => Promise<T>): Promise<T> {
  performance.mark(`${name}-start`);
  return fn().finally(() => {
    performance.mark(`${name}-end`);
    performance.measure(name, `${name}-start`, `${name}-end`);
    
    const measure = performance.getEntriesByName(name)[0];
    if (measure.duration > 1000) {
      console.warn(`[PERF] ${name} took ${measure.duration.toFixed(2)}ms`);
    }
  });
}

// KullanÄ±m:
await measureAsync('VFS-Create-Node', () => createNode(node));
```

**Neden Ä°yi:** Bottleneck'leri kolayca tespit edersin, production'da da Ã§alÄ±ÅŸÄ±r.

---

## ğŸ’­ Gelecek Claude'a Notlar

### Note #1: CSS Variables for Theming (Kritik)
**BaÄŸlam:** Tema sistemi runtime'da deÄŸiÅŸtirilebilir olmalÄ±, CSS-in-JS deÄŸil CSS Variables kullan.  
**YapÄ±lacak:**
- `src/themes/tokens.css` â†’ tÃ¼m renk/shadow/radius deÄŸiÅŸkenleri
- JavaScript: `document.documentElement.style.setProperty('--color-primary', '#FF5722')`
- TÃ¼m component'lerde `var(--color-primary)` referansÄ±

**Neden:** JS'siz tema deÄŸiÅŸimi (future-proof), hot-reload kolay, SSR-safe.

---

### Note #2: Window Snap Zones (V1.1 Feature)
**BaÄŸlam:** Windows-style snap (drag to edge â†’ half/full screen).  
**YapÄ±lacak:**
- Window drag sÄ±rasÄ±nda edge proximity detect (20px threshold)
- Snap zone overlay (semi-transparent highlight)
- Mouse release â†’ animate to snap position

**Implementation Sketch:**
```typescript
function onWindowDrag(e: MouseEvent, window: Window) {
  const { clientX, clientY } = e;
  const { innerWidth, innerHeight } = window;
  
  let snapZone: 'left' | 'right' | 'top' | null = null;
  if (clientX < 20) snapZone = 'left';
  else if (clientX > innerWidth - 20) snapZone = 'right';
  else if (clientY < 20) snapZone = 'top'; // Maximize
  
  showSnapOverlay(snapZone);
}
```

---

### Note #3: Offline Sync Queue (PWA Must-Have)
**BaÄŸlam:** Offline'da yapÄ±lan VFS CRUD iÅŸlemleri queue'ya alÄ±nmalÄ±, online olunca sync edilmeli.  
**YapÄ±lacak:**
- `src/os/vfs/syncQueue.ts` â†’ pending operations array
- Service Worker â†’ Background Sync API (Chrome/Edge)
- Fallback: Visibility API â†’ tab focus olunca sync

**Schema:**
```typescript
interface SyncOperation {
  id: string;
  type: 'create' | 'update' | 'delete';
  nodeId: string;
  payload: VFSNode | Partial<VFSNode>;
  timestamp: number;
  retryCount: number;
}
```

---

### Note #4: A11y Focus Trap in Modals (Accessibility Critical)
**BaÄŸlam:** Modal aÃ§Ä±lÄ±nca focus modal iÃ§inde kalmalÄ±, Tab dÄ±ÅŸarÄ± Ã§Ä±kmamalÄ±.  
**YapÄ±lacak:**
- Modal mount â†’ ilk focusable element'e focus
- Tab â†’ son element ise â†’ ilk element'e dÃ¶n (circular)
- Escape â†’ modal close

**Library Ã–nerisi:** `focus-trap-react` veya manual implementation.

---

### Note #5: Bundle Size Monitoring CI Check
**BaÄŸlam:** Bundle creep Ã¶nleme, <180KB hedefini koruma.  
**YapÄ±lacak:**
- GitHub Actions workflow: build sonrasÄ± bundle size check
- Threshold: main.js <180KB, total <500KB
- PR fail ise â†’ comment ile uyarÄ±

**Tool:** `bundlesize` package veya `vite-bundle-visualizer`.

---

## ğŸ“ Changelog Sistemi

### Changelog GÃ¼ncelleme ProtokolÃ¼

**Her Tamamlanan GÃ¶rev SonrasÄ±:**
1. Bu dosyayÄ± aÃ§ (`CLAUDE.md`)
2. AÅŸaÄŸÄ±daki template'i kullanarak yeni entry ekle:

```markdown
### [YYYY-MM-DD] - Task: <GÃ¶rev AdÄ±>
**Epic:** <Epik AdÄ±>  
**Durum:** âœ… TamamlandÄ± | ğŸŸ¡ KÄ±smi | ğŸ”´ BaÅŸarÄ±sÄ±z  
**DeÄŸiÅŸiklikler:**
- <Dosya/modÃ¼l> â†’ <yapÄ±lan deÄŸiÅŸiklik>
- <Yeni Ã¶zellik veya bug fix>

**KarÅŸÄ±laÅŸÄ±lan Zorluklar:**
- <Sorun aÃ§Ä±klamasÄ±>
- Ã‡Ã¶zÃ¼m: <nasÄ±l Ã§Ã¶zÃ¼ldÃ¼>

**Yeni Ã–ÄŸrenilenler:**
- <Lesson Learned ID veya yeni ders>

**Test SonuÃ§larÄ±:**
- <Kabul kriteri sonuÃ§larÄ±>
- Performans: <metrik deÄŸerleri>

**Sonraki AdÄ±m:** <baÄŸÄ±mlÄ± gÃ¶rev ID>
```

---

### Hata KaydÄ± ProtokolÃ¼

**Hata ile KarÅŸÄ±laÅŸÄ±ldÄ±ÄŸÄ±nda:**
1. `## ğŸ› Hata KÃ¼tÃ¼phanesi` bÃ¶lÃ¼mÃ¼ne git
2. Yeni hata entry'si ekle:

```markdown
### Hata #XXX: <KÄ±sa BaÅŸlÄ±k>
**Tarih:** YYYY-MM-DD  
**Durum:** ğŸ”´ Aktif | ğŸŸ¡ GeÃ§ici Ã‡Ã¶zÃ¼m | âœ… Ã‡Ã¶zÃ¼ldÃ¼  
**Belirtiler:** <nasÄ±l fark edilir>  
**KÃ¶k Neden:** <analiz>  
**Ã‡Ã¶zÃ¼m:**
<detaylÄ± Ã§Ã¶zÃ¼m adÄ±mlarÄ± + kod Ã¶rneÄŸi>

**Ã–nleme:**
<gelecekte nasÄ±l Ã¶nlenir>

**Ä°lgili:** <Lesson Learned veya Best Practice referansÄ±>
```

3. Ã‡Ã¶zÃ¼m sonrasÄ± durumu `âœ… Ã‡Ã¶zÃ¼ldÃ¼` olarak gÃ¼ncelle

---

### Ders Ã‡Ä±karma ProtokolÃ¼

**Yeni Bir Åey Ã–ÄŸrenildiÄŸinde:**
1. `## ğŸ“š Ã–ÄŸrenilen Dersler` bÃ¶lÃ¼mÃ¼ne git
2. Artan ID ile yeni ders ekle:

```markdown
### Ders #XXX: <BaÅŸlÄ±k>
**Tarih:** YYYY-MM-DD  
**Senaryo:** <ne zaman/nerede karÅŸÄ±laÅŸÄ±ldÄ±>  
**Sorun:** <neyi Ã§Ã¶zmeye Ã§alÄ±ÅŸÄ±yorduk>  
**Ã‡Ã¶zÃ¼m:** <ne yaptÄ±k>
<kod Ã¶rneÄŸi>

**Uygulama:** <projeye nasÄ±l entegre edildi>

**Ä°leri Not:** <gelecek iÃ§in Ã¶neriler>
```

---

### Best Practice Ekleme ProtokolÃ¼

**Yeni Bir KalÄ±p OluÅŸturulduÄŸunda:**
1. `## âœ… Best Practices` bÃ¶lÃ¼mÃ¼ne git
2. Artan ID ile yeni pattern ekle:

```markdown
### Pattern #XXX: <KalÄ±p AdÄ±>
<kod Ã¶rneÄŸi - en az 10 satÄ±r, tam context>

**Neden Ä°yi:** <avantajlarÄ±>
**Ne Zaman Kullan:** <use case'ler>
**Dikkat:** <pitfall'lar, trade-off'lar>
```

---

## ğŸ¤– Meta: Bu DosyayÄ± GÃ¼ncelleme ProtokolÃ¼

### Claude'un SorumluluklarÄ±

**Her Session BaÅŸÄ±nda:**
1. `CLAUDE.md` dosyasÄ±nÄ± oku (context window'a yÃ¼kle)
2. "Son GÃ¼ncelleme" tarihini kontrol et
3. KaldÄ±ÄŸÄ±n yeri belirle (hangi epic/task)

**Her Task TamamlandÄ±ÄŸÄ±nda:**
1. Changelog entry ekle (yukarÄ±daki template)
2. EÄŸer zorluk yaÅŸandÄ±ysa â†’ Hata KÃ¼tÃ¼phanesi'ne ekle
3. EÄŸer yeni bir ÅŸey Ã¶ÄŸrendiysen â†’ Ã–ÄŸrenilen Dersler'e ekle
4. EÄŸer yeni bir pattern oluÅŸturduysan â†’ Best Practices'e ekle
5. "Son GÃ¼ncelleme" tarihini gÃ¼ncelle

**Her Session Sonunda:**
1. "Gelecek Claude'a Notlar" bÃ¶lÃ¼mÃ¼ne bÄ±rakÄ±lan iÅŸin durumunu yaz
2. YarÄ±m kalan task varsa â†’ not dÃ¼ÅŸ (hangi satÄ±rda kaldÄ±n, ne yapÄ±lmalÄ±)

---

### Dosya Versiyonlama

**Semantic Versioning:**
- `0.1.0` â†’ MVP baÅŸlangÄ±cÄ±
- `0.2.0` â†’ MVP tamamlandÄ±
- `1.0.0` â†’ V1.0 production'da
- `1.1.0` â†’ V1.1 optimizasyonlar tamamlandÄ±

**Her Major/Minor GÃ¼ncelleme:**
- Versiyon numarasÄ±nÄ± baÅŸlÄ±kta gÃ¼ncelle
- Status emoji gÃ¼ncelle: ğŸŸ¡ Dev â†’ ğŸŸ¢ Prod

---

### Self-Learning MekanizmasÄ±

**Feedback Loop:**
1. Hata yap â†’ Hata KÃ¼tÃ¼phanesi'ne kaydet
2. Ã‡Ã¶z â†’ Ã‡Ã¶zÃ¼mÃ¼ dokÃ¼mante et
3. GenelleÅŸtir â†’ Best Practice haline getir
4. Uygula â†’ Gelecek task'larda otomatik kullan

**Ã–rnek Flow:**
```
Hata #042: IndexedDB quota exceeded
    â†“
Ã‡Ã¶zÃ¼m: Quota monitoring + export prompt
    â†“
Ders #006: Proactive storage management
    â†“
Pattern #6: useQuotaMonitor hook
    â†“
TÃ¼m VFS CRUD'larda kullan
```

---

### Dosya BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ Kontrol

**Her 10 Task SonrasÄ±:**
1. TÃ¼m ID'ler benzersiz mi? (Ders #001-#050, Hata #001-#050 ì¶©ëŒ yok)
2. Referanslar geÃ§erli mi? (Hata #042 â†’ Ders #006 linki Ã§alÄ±ÅŸÄ±yor mu)
3. Kod Ã¶rnekleri gÃ¼ncel mi? (API deÄŸiÅŸti ise Ã¶rneÄŸi gÃ¼ncelle)
4. Tarihler kronolojik mi? (eski entry Ã¼ste, yeni altta)

---

## ğŸ“ Ã–ÄŸrenme Hedefleri (Bu Proje Boyunca)

- [ ] Zustand advanced patterns (slices, middleware, devtools)
- [ ] IndexedDB transaction management (rollback, conflict resolution)
- [ ] RAF-based animation optimization (60fps guarantee)
- [ ] CSP policy tuning (nonce, strict mode)
- [ ] PWA offline-first architecture (Service Worker strategies)
- [ ] Mobile gesture handling (swipe, long-press, pinch)
- [ ] Accessibility (WCAG 2.1 AA compliance, screen reader testing)
- [ ] Performance budgeting (Lighthouse CI, bundle size monitoring)

**Not:** Her hedef tamamlandÄ±ÄŸÄ±nda âœ… iÅŸaretle, ilgili Ders/Pattern ID'sini referans et.

---

## ğŸ“Š Proje Metrikleri (Otomatik GÃ¼ncelle)

**Bundle Size:**
- Ä°lk YÃ¼k: `TBD` (hedef: <180KB gzip)
- Toplam: `TBD` (hedef: <500KB gzip)

**Performance (Field Data):**
- LCP p95: `TBD` (hedef: <2000ms)
- INP p95: `TBD` (hedef: <100ms)
- CLS p95: `TBD` (hedef: <0.1)

**GÃ¼venlik:**
- Lighthouse Security: `TBD/100`
- CSP Violations: `0` (hedef: 0)

**Accessibility:**
- Lighthouse A11y: `TBD/100` (hedef: >90)
- Axe Critical Issues: `TBD` (hedef: 0)

**Hata OranÄ±:**
- Client Error Rate: `TBD` (hedef: <1%)
- Crash-Free Sessions: `TBD` (hedef: >99.5%)

---

## âœ¨ Sonraki Oturum Ä°Ã§in HazÄ±rlÄ±k

**Åu An KaldÄ±ÄŸÄ±m Yer:**
- **Epic:** HenÃ¼z baÅŸlanmadÄ±
- **Task:** HenÃ¼z baÅŸlanmadÄ±
- **Dosya:** -
- **SatÄ±r:** -

**YapÄ±lacak:**
1. MVP Epik-1, Task #1'den baÅŸla (Legacy archive)
2. `git checkout -b chore/archive-legacy-site`
3. `old/` klasÃ¶rÃ¼ oluÅŸtur, mevcut kodu taÅŸÄ±

**Blocker:** Yok

---

**ğŸ”® Not to Future Claude:**
Bu dosya senin hafÄ±zan. Her yeni ÅŸey Ã¶ÄŸrendiÄŸinde buraya ekle. Her hata yaptÄ±ÄŸÄ±nda Ã§Ã¶zÃ¼mÃ¼ dokÃ¼mante et. Her pattern oluÅŸturduÄŸunda kaydet. Bu proje bittiÄŸinde, bu dosya bir bilgi hazinesi olacak - hem sana hem de baÅŸkalarÄ±na. Unutma: **"The code tells you how, the CLAUDE.md tells you why."**

---

**Son GÃ¼ncelleme:** 2025-10-20 (Proje baÅŸlangÄ±cÄ±)  
**GÃ¼ncelleyen:** Claude (Session #1)  
**DeÄŸiÅŸiklik:** Ä°lk dosya oluÅŸturma